<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WLSQB5SF');</script>
    <!-- End Google Tag Manager -->

    <!-- GA4 Network Hit Interceptor Script START (Cleaned) -->
    <script>
    </script>
    <!-- GA4 Network Hit Interceptor Script END -->

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="images/favicon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/favicon.png">

    <!-- Scripts -->
    <script src="js/gtm-ga4-interceptor.js?v=1"></script>
    <script src="js/config.js?v=3" defer></script>
    <script src="js/global-submit-handler.js?v=2" defer></script>

</head>
<body>

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WLSQB5SF"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <header>
        <div id="logo" class="logo">
            <img src="images/favicon.png" alt="Site Logo" class="logo-icon">
            Demo
        </div>
        <nav class="header-nav"> 
            <a href="#newsletter" class="header-link">Newsletter</a>
            <a href="contact.html" class="header-link">Contact</a>
        </nav>
    </header>
    
    <div class="content">

        <section id="hero" class="block" style="background-color: #fe6d6d;">
            <h1>Hero</h1>
            <div class="cta-group">
                <a href="#lead" class="cta-1">Get a quote</a>
                <a href="contact.html"  class="cta-2">Contact us</a>
            </div>
        </section>

        <section id="social-proof" class="block" style="background-color: #fe946d;">
            <h2>Social Proof</h2>
            <div class="cta-group">
                <a href="#lead" class="cta-1">Get a quote</a>
            </div>
        </section>

        <section id="problem" class="block" style="background-color: #ffcd4f;">
            <h2>Problem</h2>
            <div class="cta-group">
                <a href="#lead" class="cta-1">Get a quote</a>
            </div>
        </section>

        <section id="solution" class="block" style="background-color: #56c98f;">
            <h2>Solution</h2>
            <div class="cta-group">
                <a href="#lead" class="cta-1">Get a quote</a>
            </div>
        </section>

        <section id="case-study" class="block" style="background-color: #5cc1d7;">
            <h2>Case Study</h2>
            <div class="cta-group">
                <a href="#lead" class="cta-1">Get a quote</a>
            </div>
        </section>

        <section id="faq" class="block" style="background-color: #8ea5fa;">
            <h2>FAQ</h2>
            <div class="cta-group">
                <a href="#lead" class="cta-1">Get a quote</a>
            </div>
        </section>

        <section id="video" class="block" style="background-color: #f097fc;">
            <h2>Video</h2>

            <div class="iframe-wrapper" style="padding-top: 3rem;">
                <iframe 
                    src="https://www.youtube.com/embed/3apbS5OBuaA?enablejsapi=1" 
                    title="YouTube video player" 
                    frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                    referrerpolicy="strict-origin-when-cross-origin" 
                    allowfullscreen
                    id="video-iframe">
                </iframe>
            </div>
            
            <div class="cta-group">
                <a href="#lead" class="cta-1">Get a quote</a>
            </div>
        </section>

        <section id="lead" class="block" style="background-color: #fc97c6;">
            <h2>Lead Form</h2>
            <form id="form-lead" 
                  action="" method="post"
                  class="form-1" 
                  style="padding-top: 3rem;">
                <label for="phone">Phone</label>
                <input name="form-id" type="hidden" value="form-lead">
                <input id="phone" type="tel" name="phone" placeholder="+1 (555) 123-4567" required>
                <label for="email">Email</label>
                <input id="email" type="email" name="email" placeholder="john.doe@example.com" required>
                <label for="company">Company</label>
                <input id="company" type="text" name="company" placeholder="Acme Corp." required>
                <label for="message">Message</label>
                <textarea id="message" name="message" placeholder="I'm interested in your services." rows="4" required></textarea>
                <button id="form-lead-button" type="submit" class="form-1-button-submit">Lead submit</button>
            </form>
        </section>

        <section id="newsletter" class="block" style="background-color: #fc9797;">
            <h2>Newsletter Form</h2>
            <div class="card-group" style="display: none;">
                <div id="message-newsletter" class="card message-success">
                </div>
            </div>
            <form id="form-newsletter"
                  action="" method="post" 
                  class="form-1" 
                  style="padding-top: 3rem;">
                <label for="email">Email</label>
                <input name="form-id" type="hidden" value="form-newsletter">
                <input id="email" type="email" name="email" placeholder="john.doe@example.com" required>
                <button id="form-newsletter-button" type="submit" class="form-1-button-submit">Newsletter submit</button>
            </form>
        </section>

       <footer>
            <h2>Footer</h2>
            <div class="cta-group">
                <a href="#logo" class="cta-1">Back to top</a>
            </div>
       </footer>

    </div>

    <div class="console">
        <span id="console-message">
            <b>Last GA4 events:</b> 
            <span id="console-message-gtm">
                form-submit, scroll, click
            </span>
        </span>
    </div>

    <script>
        // Newsletter AJAX form submission
        document.addEventListener('DOMContentLoaded', () => {
            const newsletterForm = document.getElementById('form-newsletter');
            const newsletterMessageDiv = document.getElementById('message-newsletter');
            const submitButton = newsletterForm ? newsletterForm.querySelector('button[type="submit"]') : null;
            const messageContainer = newsletterMessageDiv ? newsletterMessageDiv.parentElement : null;

            if (newsletterForm && newsletterMessageDiv && submitButton && messageContainer) {
                newsletterForm.addEventListener('submit', function(event) {
                    event.preventDefault(); 

                    const formData = new FormData(newsletterForm);
                    const actionUrl = newsletterForm.getAttribute('action');

                    // Reset message area: hide container, clear text, set base class
                    if (messageContainer) {
                        messageContainer.style.display = 'none'; 
                    }
                    newsletterMessageDiv.textContent = '';
                    newsletterMessageDiv.className = 'card'; // Base class
                    submitButton.disabled = true;
                    submitButton.textContent = 'Submitting...';

                    if (!actionUrl || actionUrl.trim() === '') {
                        newsletterMessageDiv.textContent = 'Error: Form submission endpoint is not configured.';
                        newsletterMessageDiv.classList.add('message-error'); // Add error class
                        if (messageContainer) {
                            messageContainer.style.display = 'block'; 
                        }
                        submitButton.disabled = false;
                        submitButton.textContent = 'Newsletter submit';
                        return;
                    }

                    fetch(actionUrl, {
                        method: 'POST',
                        body: formData,
                    })
                    .then(response => {
                        return response.text().then(text => {
                            if (!response.ok) {
                                // For !response.ok, create an Error object that includes the response text
                                let error = new Error(`Server error: ${response.status} ${response.statusText}.`);
                                error.responseText = text; // Attach the response text to the error object
                                throw error;
                            }
                            return text; // This is the success message from the webhook
                        });
                    })
                    .then(responseText => {
                        newsletterMessageDiv.textContent = responseText;
                        newsletterMessageDiv.classList.add('message-success'); // Add success class
                        if (messageContainer) {
                            messageContainer.style.display = 'block';
                        }
                        newsletterForm.reset(); 
                    })
                    .catch(error => {
                        console.error('Newsletter AJAX submission error:', error);
                        // If error has responseText (from !response.ok), use it. Otherwise, use error.message or a generic fallback.
                        newsletterMessageDiv.textContent = error.responseText || error.message || 'Submission failed. Please try again.';
                        newsletterMessageDiv.classList.add('message-error'); // Add error class
                        if (messageContainer) {
                            messageContainer.style.display = 'block'; 
                        }
                    })
                    .finally(() => {
                        submitButton.disabled = false;
                        submitButton.textContent = 'Newsletter submit';
                    });
                });
            } else {
                if (!newsletterForm) console.error('Newsletter form (form-newsletter) not found.');
                if (!newsletterMessageDiv) console.error('Newsletter message div (message-newsletter) not found.');
                if (!submitButton) console.error('Newsletter submit button not found.');
                if (!messageContainer) console.error('Message container (parent of message-newsletter) not found.');
            }
        });
    </script>

</body>
</html>